.. _INSTALL:

============
Installation  **(UNDER CONSTRUCTION)**
============
Mindboggle comes as a single installation program, `setup_mindboggle <https://github.com/binarybottle/mindboggle/blob/master/setup_mindboggle>`_,
that creates a virtual machine where everything is installed and
configured to run Mindboggle.  See below for directions on its use.
(For those who just *have* to install from source, see guidelines in
`setup_mindboggle.sh <https://github.com/binarybottle/mindboggle/blob/master/setup_mindboggle.sh>`_.)

Dependencies
------------
Vagrant_ manages virtual machines.
    Vagrant provides reproducible and portable work environments
    that isolate dependencies and their configuration within a single
    disposable, consistent environment that can run on
    Linux, Mac OS X, or Windows.

Virtualbox_ provides virtual machines used by Vagrant.
    Alternative backend providers for Vagrant include VMware and Amazon Web Services.

Software to generate input data for Mindboggle
----------------------------------------------
Use FreeSurfer_ and ANTS_ to process T1-weighted MRI data for use by
Mindboggle (these are also installed in the Mindboggle virtual machine).
See `README <http://mindboggle.info/users/README.html>`_ for
instructions on running ``recon-all`` in FreeSurfer and
``antsCorticalThickness.sh`` in ANTs.

FreeSurfer (`download <http://surfer.nmr.mgh.harvard.edu>`_)
provides labeled cortical surfaces and non/cortical volumes.
(Note: Mindboggle expects the FreeSurfer SUBJECTS_DIR environment
variable to be set to access surfaces and other data.)

ANTs (`download <http://brianavants.wordpress.com/2012/04/13/updated-ants-compile-instructions-april-12-2012/>`_)
optionally provides tissue segmentation, affine registration to standard
space, and nonlinear registration for whole-brain labeling, to improve and
extend Mindboggle results.
(Note: After installing ANTS, be sure to copy the files in ANTs/Scripts/
to the antsbin/bin/ directory, and set the ANTSPATH environment variable.)

    ..  FreeSurfer_
            FreeSurfer provides labeled cortical surfaces, and labeled cortical and
            noncortical volumes.
            See `README <http://mindboggle.info/users/README.html>`_ for instructions
            on how to preprocess T1-weighted MRI data using the ``recon-all`` command.
            Don't forget to set these environment variables in the equivalent of your
            .bash_profile file, replacing <install_path>: ::
        
                FREESURFER_HOME=<install_path>/freesurfer
                SUBJECTS_DIR=<install_path>/freesurfer/subjects
                PATH=${FREESURFER_HOME}:${PATH}
                export FREESURFER_HOME SUBJECTS_DIR
                source $FREESURFER_HOME/SetUpFreeSurfer.sh

    ..  ANTS_
            ANTS provides brain volume extraction, tissue-class segmentation, and
            affine registration that Mindboggle uses to report locations in a standard
            space, and nonlinear registration for whole-brain labeling.
            While these are not required for Mindboggle to run, they improve and
            extend results generated by Mindboggle.
            See `README <http://mindboggle.info/users/README.html>`_ for instructions
            on how to process MRI data using the ``antsCorticalThickness.sh`` script.
            After installing ANTS, be sure to copy these files: ::
        
                cp  <install_path>/ANTs/Scripts/*  <install_path>/antsbin/bin/
        
            and set these environment variables in the equivalent of your
            .bash_profile file, replacing <install_path>: ::
        
                ANTSPATH=<install_path>/antsbin/bin/
                PATH=${ANTSPATH}:${PATH})

Configure virtual machine with mounted directories to access FreeSurfer, etc.
-----------------------------------------------------------------------------
Mindboggle's single installation program, setup_mindboggle_, generates a
configuration file called ``Vagrantfile`` for the mindboggle virtual machine
Copy ``setup_mindboggle`` to wherever you want the startup directory to be,
and make sure it is executable by typing in a terminal::

    chmod +x setup_mindboggle

Configure the virtual machine to access your local FreeSurfer subjects
directory, your local ANTs subjects directory,
and to use a given number of processors
(include Mindboggle's VERSION number)::

    python setup_mindboggle VERSION --freesurfer --ants /data/ants_out --p 6

For help with other setup options::

    python setup_mindboggle --help

See `README <http://mindboggle.info/users/README.html>`_ for instructions
on how to run Mindboggle!
