<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mindboggle &mdash; Mindboggle</title>
    
    <link rel="stylesheet" href="../../_static/mindboggle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1.0dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Mindboggle" href="../../index.html" />
  <HTML><head><title>Mindboggle</title>
  <meta http-equiv="Content-language" content="en">
  <meta name="description" content="Mindboggle">
  <meta name="keywords" content="Mindboggle, neuroimaging, brain imaging, python, neuroscience, labeling, parcellation, morphometry, shape analysis, MRI">
  <meta name="author" content="mailto:arno&#64;mindboggle.info">
  <meta name="dc.title" content="Mindboggle"> 
  <meta name="dc.creator.address" content="arno&#64;mindboggle.info">
  <meta name="dc.subject" content="Mindboggle">
  <meta name="dc.type" content="text.homepage.academic"> 
  <meta name="dc.format" content="text/html"> 
  <meta name="dc.identifier" content="http://binarybottle.github.io/mindboggle/">

  </head>
  <body role="document">
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
 <table>
  <tr>
   <td>

 <a href="../../index.html">
  <img src="http://binarybottle.github.io/mindboggle/shared/mindboggle_logo_small.jpg" alt="small mindboggle logo"  border="0" width="160"/></a>

   </td>
   <td>
    <table>
     <tr>
 <a style="padding: 20px 20px 20px 20px; color: #b07613; text-decoration: none; font-size: 32px"
  href="../../index.html">Mindboggle</a>
     </tr>
     <tr> <td height="18"></td>
     </tr>
     <tr>
      <td>
  <a style="padding: 20px 20px 20px 20px; text-decoration: none; font-size: 18px"
   href="http://binarybottle.github.io/mindboggle/users/README.html">Software</a>
      </td>
      <td>
  <a style="padding: 20px 20px 20px 20px; text-decoration: none; font-size: 18px"
   href="../../data.html">Data</a>
      </td>
      <td>
  <a style="padding: 20px 20px 20px 20px; text-decoration: none; font-size: 18px"
   href="../../papers.html">Papers</a>
      </td>
      <td>
  <a style="padding: 20px 20px 20px 20px; text-decoration: none; font-size: 18px"
   href="../../people.html">People</a>
      </td>
     </tr>
    </table>
   </td>
  </tr>
 </table>
</div>
  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="utils-ants">
<h1>utils.ants<a class="headerlink" href="#utils-ants" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-mindboggle.utils.ants">
<span id="module-utils-ants"></span><h2>Module: <code class="xref py py-mod docutils literal"><span class="pre">utils.ants</span></code><a class="headerlink" href="#module-mindboggle.utils.ants" title="Permalink to this headline">¶</a></h2>
<p>Functions that call ANTs (UPenn&#8217;s PICSL group) commands.</p>
<p>Mindboggle functions call the following ANTs functions</p>
<div class="highlight-python"><div class="highlight"><pre>ImageMath:
    &#39;PropagateLabelsThroughMask&#39;,&#39;m&#39;,&#39;MD&#39;,&#39;ME&#39; options in thickinthehead()
    &#39;PropagateLabelsThroughMask&#39; option in PropagateLabelsThroughMask()
    if modify_surface_labels set to True:
        PropagateLabelsThroughMask() called and &#39;+&#39; option in mindboggle

ThresholdImage:
    thickinthehead()
    PropagateLabelsThroughMask()

ResampleImageBySpacing:
    thickinthehead()

antsApplyTransformsToPoints:
    write_shape_stats(), write_vertex_measures()
</pre></div>
</div>
<p>Authors:
Arno Klein, 2011-2014  .  <a class="reference external" href="mailto:arno&#37;&#52;&#48;mindboggle&#46;info">arno<span>&#64;</span>mindboggle<span>&#46;</span>info</a>  .  www.binarybottle.com</p>
<p>Copyright 2014,  Mindboggle team (<a class="reference external" href="http://mindboggle.info">http://mindboggle.info</a>), Apache v2.0 License</p>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mindboggle.utils.ants.ImageMath">
<code class="descclassname">mindboggle.utils.ants.</code><code class="descname">ImageMath</code><span class="sig-paren">(</span><em>volume1</em>, <em>volume2</em>, <em>operator='m'</em>, <em>output_file=''</em><span class="sig-paren">)</span><a class="headerlink" href="#mindboggle.utils.ants.ImageMath" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the ImageMath function in ANTs to perform operation on two volumes:</p>
<div class="highlight-python"><div class="highlight"><pre>m         : Multiply ---  use vm for vector multiply
+         : Add ---  use v+ for vector add
-         : Subtract ---  use v- for vector subtract
/         : Divide
^         : Power
exp       : Take exponent exp(imagevalue*value)
addtozero : add image-b to image-a only over points where image-a has zero values
overadd   : replace image-a pixel with image-b pixel if image-b pixel is non-zero
abs       : absolute value
total     : Sums up values in an image or in image1*image2 (img2 is the probability mask)
mean      :  Average of values in an image or in image1*image2 (img2 is the probability mask)
vtotal    : Sums up volumetrically weighted values in an image or in image1*image2 (img2 is the probability mask)
Decision  : Computes result=1./(1.+exp(-1.0*( pix1-0.25)/pix2))
Neg       : Produce image negative
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>volume1</strong> : string</p>
<blockquote>
<div><p>nibabel-readable image volume</p>
</div></blockquote>
<p><strong>volume2</strong> : string</p>
<blockquote>
<div><p>nibabel-readable image volume</p>
</div></blockquote>
<p><strong>operator</strong> : string</p>
<blockquote>
<div><p>ImageMath string corresponding to mathematical operator</p>
</div></blockquote>
<p><strong>output_file</strong> : string</p>
<blockquote>
<div><p>nibabel-readable image volume</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>output_file</strong> : string</p>
<blockquote class="last">
<div><p>name of output nibabel-readable image volume</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.ants</span> <span class="kn">import</span> <span class="n">ImageMath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.plots</span> <span class="kn">import</span> <span class="n">plot_volumes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;MINDBOGGLE_DATA&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">volume1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;arno&#39;</span><span class="p">,</span> <span class="s">&#39;mri&#39;</span><span class="p">,</span> <span class="s">&#39;t1weighted.nii.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">volume2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;arno&#39;</span><span class="p">,</span> <span class="s">&#39;mri&#39;</span><span class="p">,</span> <span class="s">&#39;mask.nii.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">operator</span> <span class="o">=</span> <span class="s">&#39;m&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span> <span class="o">=</span> <span class="n">ImageMath</span><span class="p">(</span><span class="n">volume1</span><span class="p">,</span> <span class="n">volume2</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># View</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_volumes</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mindboggle.utils.ants.PropagateLabelsThroughMask">
<code class="descclassname">mindboggle.utils.ants.</code><code class="descname">PropagateLabelsThroughMask</code><span class="sig-paren">(</span><em>mask</em>, <em>labels</em>, <em>mask_index=None</em>, <em>output_file=''</em>, <em>binarize=True</em>, <em>stopvalue=''</em><span class="sig-paren">)</span><a class="headerlink" href="#mindboggle.utils.ants.PropagateLabelsThroughMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Use ANTs to fill a binary volume mask with initial labels.</p>
<p>This program uses ThresholdImage and the ImageMath
PropagateLabelsThroughMask functions in ANTs.</p>
<dl class="docutils">
<dt>ThresholdImage ImageDimension ImageIn.ext outImage.ext</dt>
<dd>threshlo threshhi &lt;insideValue&gt; &lt;outsideValue&gt;</dd>
<dt>PropagateLabelsThroughMask: Final output is the propagated label image.</dt>
<dd>ImageMath ImageDimension Out.ext PropagateLabelsThroughMask
speed/binaryimagemask.nii.gz initiallabelimage.nii.gz ...</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>mask</strong> : string</p>
<blockquote>
<div><p>nibabel-readable image volume</p>
</div></blockquote>
<p><strong>labels</strong> : string</p>
<blockquote>
<div><p>nibabel-readable image volume with integer labels</p>
</div></blockquote>
<p><strong>mask_index</strong> : integer (optional)</p>
<blockquote>
<div><p>mask with just voxels having this value</p>
</div></blockquote>
<p><strong>output_file</strong> : string</p>
<blockquote>
<div><p>nibabel-readable labeled image volume</p>
</div></blockquote>
<p><strong>binarize</strong> : Boolean</p>
<blockquote>
<div><p>binarize mask?</p>
</div></blockquote>
<p><strong>stopvalue</strong> : integer</p>
<blockquote>
<div><p>stopping value</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>output_file</strong> : string</p>
<blockquote class="last">
<div><p>name of labeled output nibabel-readable image volume</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.ants</span> <span class="kn">import</span> <span class="n">PropagateLabelsThroughMask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.plots</span> <span class="kn">import</span> <span class="n">plot_volumes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;MINDBOGGLE_DATA&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;arno&#39;</span><span class="p">,</span> <span class="s">&#39;labels&#39;</span><span class="p">,</span> <span class="s">&#39;labels.DKT25.manual.nii.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;arno&#39;</span><span class="p">,</span> <span class="s">&#39;mri&#39;</span><span class="p">,</span> <span class="s">&#39;t1weighted_brain.nii.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_index</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binarize</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stopvalue</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span> <span class="o">=</span> <span class="n">PropagateLabelsThroughMask</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mask_index</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">binarize</span><span class="p">,</span> <span class="n">stopvalue</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># View</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_volumes</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mindboggle.utils.ants.ThresholdImage">
<code class="descclassname">mindboggle.utils.ants.</code><code class="descname">ThresholdImage</code><span class="sig-paren">(</span><em>volume</em>, <em>output_file=''</em>, <em>threshlo=1</em>, <em>threshhi=10000</em><span class="sig-paren">)</span><a class="headerlink" href="#mindboggle.utils.ants.ThresholdImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the ThresholdImage function in ANTs to threshold image volume:</p>
<dl class="docutils">
<dt>Usage: ThresholdImage ImageDimension ImageIn.ext outImage.ext</dt>
<dd>threshlo threshhi &lt;insideValue&gt; &lt;outsideValue&gt;</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>volume</strong> : string</p>
<blockquote>
<div><p>nibabel-readable image volume</p>
</div></blockquote>
<p><strong>output_file</strong> : string</p>
<blockquote>
<div><p>nibabel-readable image volume</p>
</div></blockquote>
<p><strong>threshlo</strong> : integer</p>
<blockquote>
<div><p>lower threshold</p>
</div></blockquote>
<p><strong>threshhi</strong> : integer</p>
<blockquote>
<div><p>upper threshold</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>output_file</strong> : string</p>
<blockquote class="last">
<div><p>name of output nibabel-readable image volume</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.ants</span> <span class="kn">import</span> <span class="n">ThresholdImage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.plots</span> <span class="kn">import</span> <span class="n">plot_volumes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;MINDBOGGLE_DATA&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">volume</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;arno&#39;</span><span class="p">,</span> <span class="s">&#39;mri&#39;</span><span class="p">,</span> <span class="s">&#39;t1weighted.nii.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threshlo</span> <span class="o">=</span> <span class="mi">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threshhi</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span> <span class="o">=</span> <span class="n">ThresholdImage</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">threshlo</span><span class="p">,</span> <span class="n">threshhi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># View</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_volumes</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mindboggle.utils.ants.antsApplyTransformsToPoints">
<code class="descclassname">mindboggle.utils.ants.</code><code class="descname">antsApplyTransformsToPoints</code><span class="sig-paren">(</span><em>points, transform_files, inverse_booleans=[0]</em><span class="sig-paren">)</span><a class="headerlink" href="#mindboggle.utils.ants.antsApplyTransformsToPoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Run ANTs antsApplyTransformsToPoints function to transform points.
(Creates pre- and post-transformed .csv points files for ANTs.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>points</strong> : list of lists of three integers</p>
<blockquote>
<div><p>point coordinate data</p>
</div></blockquote>
<p><strong>transform_files</strong> : list</p>
<blockquote>
<div><p>transform file names</p>
</div></blockquote>
<p><strong>inverse_booleans</strong> : list</p>
<blockquote>
<div><p>for each transform, one to apply inverse of transform (otherwise zero)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>transformed_points</strong> : list of lists of three integers</p>
<blockquote class="last">
<div><p>transformed point coordinate data</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.ants</span> <span class="kn">import</span> <span class="n">antsApplyTransformsToPoints</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.io_vtk</span> <span class="kn">import</span> <span class="n">read_vtk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transform_files</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;/Users/arno/Data/antsCorticalThickness/Twins-2-1/antsTemplateToSubject1GenericAffine.mat&#39;</span><span class="p">,</span><span class="s">&#39;/Users/arno/Data/antsCorticalThickness/Twins-2-1/antsTemplateToSubject0Warp.nii.gz&#39;</span><span class="p">,</span><span class="s">&#39;/Users/arno/Data/antsCorticalThickness/Twins-2-1/antsSubjectToTemplate0GenericAffine.mat&#39;</span><span class="p">,</span><span class="s">&#39;/Users/arno/Data/antsCorticalThickness/Twins-2-1/antsSubjectToTemplate1Warp.nii.gz&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transform_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">transform_files</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">transform_files</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s">&#39;/Users/arno/Data/mindboggle_cache/f36e3d5d99f7c4a9bb70e2494ed7340b/OASIS-30_Atropos_template_to_MNI152_affine.txt&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vtk_file</span> <span class="o">=</span> <span class="s">&#39;/Users/arno/mindboggle_working/Twins-2-1/Mindboggle/_hemi_lh/Surface_to_vtk/lh.pial.vtk&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">faces</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">scalars</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">foo1</span> <span class="o">=</span> <span class="n">read_vtk</span><span class="p">(</span><span class="n">vtk_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inverse_booleans</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transformed_points</span> <span class="o">=</span> <span class="n">antsApplyTransformsToPoints</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">transform_files</span><span class="p">,</span> <span class="n">inverse_booleans</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mindboggle.utils.ants.fetch_ants_data">
<code class="descclassname">mindboggle.utils.ants.</code><code class="descname">fetch_ants_data</code><span class="sig-paren">(</span><em>segmented_file</em>, <em>use_ants_transforms=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mindboggle.utils.ants.fetch_ants_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch antsCorticalThickness.sh output.</p>
<p>The input argument &#8220;segmented_file&#8221; is one of the relevant
antsCorticalThickness.sh output files called by Mindboggle
(assume path and PREFIX=&#8221;ants&#8221;):</p>
<blockquote>
<div>ants_subjects/subject1/antsBrainExtractionMask.nii.gz
ants_subjects/subject1/antsBrainSegmentation.nii.gz
ants_subjects/subject1/antsSubjectToTemplate0GenericAffine.mat
ants_subjects/subject1/antsSubjectToTemplate1Warp.nii.gz
ants_subjects/subject1/antsTemplateToSubject0Warp.nii.gz
ants_subjects/subject1/antsTemplateToSubject1GenericAffine.mat</div></blockquote>
<p>The existence of the transform files are checked only if
use_ants_transforms == True. Transforms can only be included
if they have been generated by antsCorticalThickness.sh
with the -k argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>segmented_file</strong> : string</p>
<blockquote>
<div><p>full path to a subject&#8217;s antsCorticalThickness.sh segmented file</p>
</div></blockquote>
<p><strong>use_ants_transforms</strong> : Boolean</p>
<blockquote>
<div><p>include antsCorticalThickness.sh-generated transforms?</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mask</strong> : string</p>
<blockquote>
<div><p>antsBrainExtraction.sh brain volume mask for extracting brain volume</p>
</div></blockquote>
<p><strong>segments</strong> : string</p>
<blockquote>
<div><p>Atropos-segmented brain volume</p>
</div></blockquote>
<p><strong>affine_subject2template</strong> : string</p>
<blockquote>
<div><p>subject to template affine transform (antsRegistration)</p>
</div></blockquote>
<p><strong>warp_subject2template</strong> : string</p>
<blockquote>
<div><p>subject to template nonlinear transform (antsRegistration)</p>
</div></blockquote>
<p><strong>affine_template2subject</strong> : string</p>
<blockquote>
<div><p>template to subject affine transform (antsRegistration)</p>
</div></blockquote>
<p><strong>warp_template2subject</strong> : string</p>
<blockquote class="last">
<div><p>template to subject nonlinear transform (antsRegistration)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.ants</span> <span class="kn">import</span> <span class="n">fetch_ants_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segmented_file</span> <span class="o">=</span> <span class="s">&#39;ants_subjects/OASIS-TRT-20-1/tmpBrainSegmentation.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fetch_ants_data</span><span class="p">(</span><span class="n">segmented_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mindboggle.utils.ants.fill_volume_with_surface_labels">
<code class="descclassname">mindboggle.utils.ants.</code><code class="descname">fill_volume_with_surface_labels</code><span class="sig-paren">(</span><em>hemi</em>, <em>left_mask</em>, <em>right_mask</em>, <em>surface_files</em>, <em>mask_index=None</em>, <em>output_file=''</em>, <em>binarize=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mindboggle.utils.ants.fill_volume_with_surface_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Use ANTs to fill a volume mask with surface mesh labels.</p>
<p>Note</p>
<div class="highlight-python"><div class="highlight"><pre>- This uses PropagateLabelsThroughMask in the ANTs ImageMath function.

- Partial volume information is lost when mapping surface to volume.
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>hemi</strong> : string</p>
<blockquote>
<div><p>either &#8216;lh&#8217; or &#8216;rh&#8217;, indicating brain&#8217;s left or right hemisphere</p>
</div></blockquote>
<p><strong>left_mask</strong> : string</p>
<blockquote>
<div><p>nibabel-readable left brain image mask volume</p>
</div></blockquote>
<p><strong>right_mask</strong> : string</p>
<blockquote>
<div><p>nibabel-readable left brain image mask volume</p>
</div></blockquote>
<p><strong>surface_files</strong> : string or list of strings</p>
<blockquote>
<div><p>VTK file(s) containing surface mesh(es) with labels as scalars</p>
</div></blockquote>
<p><strong>mask_index</strong> : integer (optional)</p>
<blockquote>
<div><p>mask with just voxels having this value</p>
</div></blockquote>
<p><strong>output_file</strong> : string</p>
<blockquote>
<div><p>name of output file</p>
</div></blockquote>
<p><strong>binarize</strong> : Boolean</p>
<blockquote>
<div><p>binarize mask?</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>output_file</strong> : string</p>
<blockquote class="last">
<div><p>name of labeled output nibabel-readable image volume</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.ants</span> <span class="kn">import</span> <span class="n">fill_volume_with_surface_labels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.plots</span> <span class="kn">import</span> <span class="n">plot_volumes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">&#39;MINDBOGGLE_DATA&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;arno&#39;</span><span class="p">,</span> <span class="s">&#39;labels&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s">&#39;lh.labels.DKT25.manual.vtk&#39;</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;arno&#39;</span><span class="p">,</span> <span class="s">&#39;labels&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s">&#39;rh.labels.DKT25.manual.vtk&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># For a quick test, simply mask with whole brain:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hemi</span> <span class="o">=</span> <span class="s">&#39;rh&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">left_mask</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;arno&#39;</span><span class="p">,</span> <span class="s">&#39;mri&#39;</span><span class="p">,</span> <span class="s">&#39;t1weighted_brain.nii.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">right_mask</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s">&#39;arno&#39;</span><span class="p">,</span> <span class="s">&#39;mri&#39;</span><span class="p">,</span> <span class="s">&#39;t1weighted_brain.nii.gz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_index</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binarize</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span> <span class="o">=</span> <span class="n">fill_volume_with_surface_labels</span><span class="p">(</span><span class="n">hemi</span><span class="p">,</span> <span class="n">left_mask</span><span class="p">,</span> <span class="n">right_mask</span><span class="p">,</span> <span class="n">surface_files</span><span class="p">,</span> <span class="n">mask_index</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">binarize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># View</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_volumes</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mindboggle.utils.ants.thickinthehead">
<code class="descclassname">mindboggle.utils.ants.</code><code class="descname">thickinthehead</code><span class="sig-paren">(</span><em>segmented_file</em>, <em>labeled_file</em>, <em>cortex_value=2</em>, <em>noncortex_value=3</em>, <em>labels=[]</em>, <em>names=[]</em>, <em>resize=True</em>, <em>propagate=True</em>, <em>output_dir=''</em>, <em>save_table=False</em>, <em>output_table=''</em><span class="sig-paren">)</span><a class="headerlink" href="#mindboggle.utils.ants.thickinthehead" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a simple thickness measure for each labeled cortex region.</p>
<p>Note:</p>
<div class="highlight-python"><div class="highlight"><pre>- Cortex, noncortex, &amp; label files are from the same coregistered brain.
- Calls ANTs functions: ImageMath, Threshold, ResampleImageBySpacing
- There may be slight discrepancies between volumes computed by
  thickinthehead() and volumes computed by volume_per_label();
  in 31 of 600+ ADNI 1.5T images, some volume_per_label() volumes
  were slightly larger (in the third decimal place), presumably due to
  label propagation through the cortex.
</pre></div>
</div>
<p>Example preprocessing steps</p>
<div class="highlight-python"><div class="highlight"><pre>1. Run Freesurfer and antsCorticalThickness.sh on T1-weighted image.
2. Convert FreeSurfer volume labels (e.g., wmparc.mgz or aparc+aseg.mgz)
   to cortex (2) and noncortex (3) segments using relabel_volume()
   function [refer to LABELS.py or FreeSurferColorLUT labels file].
3. Convert ANTs Atropos-segmented volume (tmpBrainSegmentation.nii.gz)
   to cortex and noncortex segments, by converting 1-labels to 0 and
   4-labels to 3 with the relabel_volume() function
   (the latter is to include deep-gray matter with noncortical tissues).
4. Combine FreeSurfer and ANTs segmentation volumes to obtain a single
   cortex (2) and noncortex (3) segmentation file using the function
   combine_2labels_in_2volumes(). This function takes the union of
   cortex voxels from the segmentations, the union of the noncortex
   voxels from the segmentations, and overwrites intersecting cortex
   and noncortex voxels with noncortex (3) labels.
   ANTs tends to include more cortical gray matter at the periphery of
   the brain than Freesurfer, and FreeSurfer tends to include more white
   matter that extends deep into gyral folds than ANTs, so the above
   attempts to remedy their differences by overlaying ANTs cortical gray
   with FreeSurfer white matter.
5. Optional, see Step 2 below:
   Fill segmented cortex with cortex labels and noncortex with
   noncortex labels using the PropagateLabelsThroughMask() function
   (which calls ImageMath ... PropagateLabelsThroughMask in ANTs).
   The labels can be initialized using FreeSurfer (e.g. wmparc.mgz)
   or ANTs (by applying the nonlinear inverse transform generated by
   antsCorticalThickness.sh to labels in the Atropos template space).
   [Note: Any further labeling steps may be applied, such as
   overwriting cerebrum with intersecting cerebellum labels.]
</pre></div>
</div>
<p>Steps</p>
<div class="highlight-python"><div class="highlight"><pre>1. Extract noncortex and cortex.
2. Either mask labels with cortex or fill cortex with labels.
3. Resample cortex and noncortex files from 1x1x1 to 0.5x0.5x0.5
   to better represent the contours of the boundaries of the cortex.
4. Extract outer and inner boundary voxels of the cortex,
   by eroding 1 (resampled) voxel for cortex voxels (2) bordering
   the outside of the brain (0) and bordering noncortex (3).
5. Estimate middle cortical surface area by the average volume
   of the outer and inner boundary voxels of the cortex.
6. Compute the volume of a labeled region of cortex.
7. Estimate the thickness of the labeled cortical region as the
   volume of the labeled region (#6) divided by the surface area (#5).
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>segmented_file</strong> : string</p>
<blockquote>
<div><p>image volume with cortex and noncortex (and any other) labels</p>
</div></blockquote>
<p><strong>labeled_file</strong> : string</p>
<blockquote>
<div><p>corresponding image volume with index labels</p>
</div></blockquote>
<p><strong>cortex_value</strong> : integer</p>
<blockquote>
<div><p>cortex label value in segmented_file</p>
</div></blockquote>
<p><strong>noncortex_value</strong> : integer</p>
<blockquote>
<div><p>noncortex label value in segmented_file</p>
</div></blockquote>
<p><strong>labels</strong> : list of integers</p>
<blockquote>
<div><p>label indices</p>
</div></blockquote>
<p><strong>names</strong> : list of strings</p>
<blockquote>
<div><p>label names</p>
</div></blockquote>
<p><strong>resize</strong> : Boolean</p>
<blockquote>
<div><p>resize (2x) segmented_file for more accurate thickness estimates?</p>
</div></blockquote>
<p><strong>propagate</strong> : Boolean</p>
<blockquote>
<div><p>propagate labels through cortex?</p>
</div></blockquote>
<p><strong>output_dir</strong> : string</p>
<blockquote>
<div><p>output directory</p>
</div></blockquote>
<p><strong>save_table</strong> : Boolean</p>
<blockquote>
<div><p>save output table file with label volumes and thickness values?</p>
</div></blockquote>
<p><strong>output_table</strong> : string</p>
<blockquote>
<div><p>name of output table file with label volumes and thickness values</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>label_volume_thickness</strong> : list of lists of integers and floats</p>
<blockquote>
<div><p>label indices, volumes, and thickness values (default -1)</p>
</div></blockquote>
<p><strong>output_table</strong> : string</p>
<blockquote class="last">
<div><p>name of output table file with label volumes and thickness values</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindboggle.utils.ants</span> <span class="kn">import</span> <span class="n">thickinthehead</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">segmented_file</span> <span class="o">=</span> <span class="s">&#39;/Users/arno/Data/antsCorticalThickness/OASIS-TRT-20-1/antsBrainSegmentation.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labeled_file</span> <span class="o">=</span> <span class="s">&#39;/appsdir/freesurfer/subjects/OASIS-TRT-20-1/mri/labels.DKT31.manual.nii.gz&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cortex_value</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noncortex_value</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c">#labels = [2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1002</span><span class="p">,</span><span class="mi">1036</span><span class="p">)</span> <span class="o">+</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2002</span><span class="p">,</span><span class="mi">2036</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">1004</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2004</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">1032</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2032</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">1033</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2033</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resize</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">propagate</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_dir</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_table</span> <span class="o">=</span> <span class="bp">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_table</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label_volume_thickness</span><span class="p">,</span> <span class="n">output_table</span> <span class="o">=</span> <span class="n">thickinthehead</span><span class="p">(</span><span class="n">segmented_file</span><span class="p">,</span> <span class="n">labeled_file</span><span class="p">,</span> <span class="n">cortex_value</span><span class="p">,</span> <span class="n">noncortex_value</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">resize</span><span class="p">,</span> <span class="n">propagate</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span> <span class="n">save_table</span><span class="p">,</span> <span class="n">output_table</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
<!-- Google Analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-693862-13");
pageTracker._trackPageview();
} catch(err) {}
</script>

  </body>
</html>